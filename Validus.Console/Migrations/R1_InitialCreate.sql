CREATE TABLE [dbo].[Users] (
    [Id] [int] NOT NULL IDENTITY,
    [DomainLogon] [nvarchar](256) NOT NULL,
    [IsActive] [bit] NOT NULL,
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[TeamMemberships] (
    [Id] [int] NOT NULL IDENTITY,
    [TeamId] [int] NOT NULL,
    [UserId] [int] NOT NULL,
    [StartDate] [datetime] NOT NULL,
    [EndDate] [datetime],
    [PrimaryTeamMembership] [bit] NOT NULL,
    [IsCurrent] [bit] NOT NULL,
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.TeamMemberships] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_TeamId] ON [dbo].[TeamMemberships]([TeamId])
CREATE INDEX [IX_UserId] ON [dbo].[TeamMemberships]([UserId])
CREATE TABLE [dbo].[Teams] (
    [Id] [int] NOT NULL IDENTITY,
    [Title] [nvarchar](256) NOT NULL,
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.Teams] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[Links] (
    [Id] [int] NOT NULL IDENTITY,
    [Url] [nvarchar](2048) NOT NULL,
    [Title] [nvarchar](256) NOT NULL,
    [Category] [nvarchar](256),
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.Links] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[TemplatedPages] (
    [Id] [int] NOT NULL IDENTITY,
    [ViewModel] [nvarchar](max) NOT NULL,
    [PageTitle] [nvarchar](max) NOT NULL,
    [IsMenuLinkVisible] [bit] NOT NULL,
    [IsSeparateBrowserTab] [bit] NOT NULL,
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.TemplatedPages] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[PageTemplates] (
    [Id] [int] NOT NULL IDENTITY,
    [TemplateId] [int] NOT NULL,
    [PageSectionId] [int] NOT NULL,
    [IsVisible] [bit] NOT NULL,
    [IsReadOnly] [bit] NOT NULL,
    [TeamId] [int] NOT NULL,
    [TemplatedPageId] [int] NOT NULL,
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.PageTemplates] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_TemplateId] ON [dbo].[PageTemplates]([TemplateId])
CREATE INDEX [IX_TeamId] ON [dbo].[PageTemplates]([TeamId])
CREATE INDEX [IX_TemplatedPageId] ON [dbo].[PageTemplates]([TemplatedPageId])
CREATE TABLE [dbo].[Templates] (
    [Id] [int] NOT NULL IDENTITY,
    [Title] [nvarchar](max) NOT NULL,
    [Url] [nvarchar](max) NOT NULL,
    [IsPageStructureTemplate] [bit] NOT NULL,
    [AfterRenderDomFunction] [nvarchar](max),
    [TemplatePictureUrl] [nvarchar](max),
    [CreatedOn] [datetime],
    [ModifiedOn] [datetime],
    [CreatedBy] [nvarchar](256),
    [ModifiedBy] [nvarchar](256),
    CONSTRAINT [PK_dbo.Templates] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[LinkTeams] (
    [Link_Id] [int] NOT NULL,
    [Team_Id] [int] NOT NULL,
    CONSTRAINT [PK_dbo.LinkTeams] PRIMARY KEY ([Link_Id], [Team_Id])
)
CREATE INDEX [IX_Link_Id] ON [dbo].[LinkTeams]([Link_Id])
CREATE INDEX [IX_Team_Id] ON [dbo].[LinkTeams]([Team_Id])
ALTER TABLE [dbo].[TeamMemberships] ADD CONSTRAINT [FK_dbo.TeamMemberships_dbo.Teams_TeamId] FOREIGN KEY ([TeamId]) REFERENCES [dbo].[Teams] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[TeamMemberships] ADD CONSTRAINT [FK_dbo.TeamMemberships_dbo.Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[Users] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[PageTemplates] ADD CONSTRAINT [FK_dbo.PageTemplates_dbo.Templates_TemplateId] FOREIGN KEY ([TemplateId]) REFERENCES [dbo].[Templates] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[PageTemplates] ADD CONSTRAINT [FK_dbo.PageTemplates_dbo.Teams_TeamId] FOREIGN KEY ([TeamId]) REFERENCES [dbo].[Teams] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[PageTemplates] ADD CONSTRAINT [FK_dbo.PageTemplates_dbo.TemplatedPages_TemplatedPageId] FOREIGN KEY ([TemplatedPageId]) REFERENCES [dbo].[TemplatedPages] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[LinkTeams] ADD CONSTRAINT [FK_dbo.LinkTeams_dbo.Links_Link_Id] FOREIGN KEY ([Link_Id]) REFERENCES [dbo].[Links] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[LinkTeams] ADD CONSTRAINT [FK_dbo.LinkTeams_dbo.Teams_Team_Id] FOREIGN KEY ([Team_Id]) REFERENCES [dbo].[Teams] ([Id]) ON DELETE CASCADE
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](255) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId])
)
BEGIN TRY
    EXEC sp_MS_marksystemobject 'dbo.__MigrationHistory'
END TRY
BEGIN CATCH
END CATCH
INSERT INTO [__MigrationHistory] ([MigrationId], [Model], [ProductVersion]) VALUES ('201403071706112_R1_IntialCreate', 0x1F8B0800000000000400ED5DDB6EE4B8117D0F907F10F4940458B76776124C06ED5DF81A183B1E0FDC1EBF1AB4C46E13AB4B47627BED6FCB433E29BF105257DE455D5AAD36FACD4D91C52259755845B2CAFFFBCF7FE7BFBE8681F3029314C5D189FBE1E8D87560E4C53E8A5627EE062F7FFAECFEFACB9FFF34BFF4C357E7A1ACF733AD475A46E989FB8CF1FACB6C967ACF3004E95188BC244EE3253EF2E27006FC78F6F1F8F89FB30F1F66909070092DC799DF6D228C4298FD203FCFE3C8836BBC01C14DECC3202DCAC9974546D5F9064298AE81074FDC0710207F931E9136691CC0A30B8081EB9C0608105E163058BACEFAD3971F295CE0248E568B35C00804F76F6B48BE2F4190C282F32FEB4FB6CC1F7FA4CCCF4014C598908BA34E8377AB6191815D9209C06F94AD6C70272EE138616B903ABFC137AE80147D4FE2354CF0DB1D5C16EDAE7DD799F1ED6662C3AA19D386764DFE8AF0CF1F5DE7DB2608C05300AB192253B8C07102FF052398000CFDEF00639844B42DCC58977A15FAB8884380A2AFF18ACE56DE1959112256AE73855EA1FF15462BFC5C7578035ECB928F7FFF87EBFC88109142D208271BA860D0DCF9757AEA61F402CB9ECF62222A206A4DE73C8174F0B7D51088B4C17B22B92CA59C43332122D7688986A054B074F636E8ACB619C3185D7F032F6895A99AC0C43D04E10D0C9F08123DA375EA3A7730C8EAD19F39001CF1751E33CD72AE9238BC8B038944F6F9F11E242B88C9B8627D9D45BC493C81D5F9AC5664A37AF304DF93A2D39135F763A641E7B72F8D050609A65A65D2302B4A9791DF44C7465FBE272804C99BB0F23D11E93A3DDF2409599903B4BD4768D3E2D923077A3C98B1DF9448C65550C19889AD1C3E8781D9B26F13CC9603E80CB3EF0A5C110EE0F8F6D3011CA6060E36368F3546A8D4500922B6DC7D45D1EF6ABEE897474A9FE3A82E95F08AF9D4CBE0A274DE1312FC4882B6E277FCE9735F20D815FE90295AC5C9F8BA7E00BEA9015F811D5DA045843905EA743432C275902BF10ABE278C7940F08FEC04AEE57A933FFB6A3C9DCA2E603340D7D7E90D8C3654381E508A9E6A16BAFB680BB8067409CE92F80F62D3DE83A783BBB68FC0640D0999F816B0F09E10A11C53DFC3193A3F0BE85104EF4BEA3A1D4C4DEF20207A10BCF5A534C41118B7A9F42576408BE999310538A82C19163D1EEB9AB551A3AC20D937EA5A6D7D39ED3194409ED6D27248FCC906EE488DF69CB17697F54416D51B6633AB6537A579D5414CC877B557ECC67C6BEF180F6233663B1A69EBE14D526FFD3D3792D32599F23B18F930B988C3AB4DE4E5B7CD030ECF0631CBE17C47D9E8869EE183233ED51D4C875FA7691A7B28435B6697E0CE1BF9015C46BED374F8980FA43CBC247C6F028CD601F2080327EE075744C2DBE802061043E734D30A7A4A947AC097678F0CC2B766A73A7FE4D9616FEC78C6FE26F547A019D22B390402FA2A0527004558C6711479680D82867911DA59EE0074D4550FE2970BB8A69012E18639B0E9BA3475E5EEAB5E84C5689A9DF98C912EB3D031273EBAF5551DFFD42B9B1D0A37AEA7929A464E1AA8B5189CEA3ACD24C5DABBB5EE826CEE403103F99DDF1615B7B36A69981F49BB346B63D37BF91462270AA676447442D2E095D462C29D8EB49042B343C309BA9AF8EE65D1388411A4D1B84676805F9F004D4126A5FB7DADB8B03EE8E0B2C8B8AF631A3243C860CDFAF8F257AFC9E48D0DC359422BBC120E16B6848AFC9984021A8B539089CBA66230BB02496EDDDA206575823B82D8E6EE1A6983490B98949E6AFE36FE0EAEE314617A8F2ECA126DB58098B13952D7A97D3FCEBC9304916F2CBDC895C88866A805411D99C6C6C54B14A9716EF937F6CCACA09A054E991AC8B162A5A2C60380256F26B624228CD4F0F3CB3F1562AAE99E1389A26CE1E05723A8965452080BBF5CA0C2F12D42123F5C8BA9609F10C893A073379B1C4E86E5421C0D0357B8984D13D761A0CAB79AEA6537FAA0D65EA8FDB259FB9D0CC902B07A4F8BE6E2459E180BC7A8856BC48C44C008C3D4989D216EBE35E4FA4F1005E0C6C9112D744B1B7D884961ACF22D2891E976C9526414F6635B0B7238E1E16D46850495FBA0F5CC95E7C79541527D9BCFF250BEA2603ED3C4FCCD6FC07A8DA21513035894388B3C00F0FCA745FBF0BB30A731F3382817CDA7AA27623391910B5FA95DE5C32B94A434CC043C017AD87EEE878A6A96E657D91F6B85C96B586EF6656DFA77F15E4B110B79A402ED7A16AFC8C0426AF966977D02A4CACD1C1A8209029028EE13CFE36013467A035CDF9A8B0D64C9701FECE9D5E17E1C4F55A93D25E6DA8925C514DBD3626F9E58626C796BCEE8159082B333E976D6863391185B2E539BCF041992DC1B4956259791177C2BB510CD87DE0A620AC5CB2836A94A1381ED284D7918C252D01D90E8A994C7CB2C15DD91B39E0A136BC712628AED6955D1762CA5AAD09E8E26DC8EA5AAA9D20668AAE83B1E69AAE203D4EC39D40C04301D61653430C9DFEA705892171D04788F05383F6EE82DC072EC5446A74980D5CDB623C0D99B246E13A305232B4015A5C44959557A50A53D5625C1071E6053309C0058ED0EC6F6DBD13226208825C214B7B0CFEA081FCE26AB8BDBD86152C80E6F8F499FDBD05645EFF0E455350EDABEC7DACE9FA4F556767D385046AF49D7CDCDB7E55ED6EF3C781753FFFE434F4D88F711159EF9D4463135CADE49C9EBD81F9E585D3EB66B2EDD1FAB96417BB9ACA77B809BC9C1CD8050D30366468798016CEEBE76BF36708347014D25FB7E74911C6C37BA3AED21830DD450A106FBFD001CFB001CFC159BECE597AF162C3CF9B2AACA5DD7DDD62AF2BBF08F1CE409B1028C8C90FA6D14D36B2B86B4CFC4AC18CAEE8CDB3124DE7FCAEB275D838A552AE9A9AE43856BCF797105D99C0F55BA93CCABB80EE1FD05F9F43E72F1966218E602B1F877701EA0ECA8BAAC700322B48429BE8F7F87114D1B73FC5948A8DA21D9E92C4DFD608A194F111D7A63A463CBB83D45B2D3E80524DE3348E478AC9EB94C9F10EE1F0FEE939F789068BAAE94A4683A9B09EB162CD78DF2DEA4F6DC8A44F3290DB22E7AE5F4EC4241CAE8A992B52E193DBBCAAC31A36717BD94B2791E947B82CAFD5E549A8DCF1F6C7B3A48DF16A56F37490CB7227D4C1201F5A465D90AA721D280CF3E3894F81C5465AB40BDD3A47C5BD119291F5F39877F09C1EB5FFBE7D8EB474E9B37AF9B25A4CF9977308A26A66BBBCD76B7257F474C74D7C56351A6B9EB42484A72D74DA7C404775DA8F4F70435A9EDBA903AA8F5085BE87B51E9E1B63A85F1DA75CF34E60DEBA29FE69C615A76FBE501EB45F6A0C45B7619BB1E5AE86F67E4BA9A8B9366ADAF3AE9B3A1147DDB92D8525EB35D2631930F20C7CD5D367E2AA5E9A70C6993C22B0FC11E3397D674E44713A23805F9D9A3F45BA2F1305E262C755C718FE4361D5148FBF26970496A78D0A9C2A1BD499BB5CB9D6CB7F233CE2ED64176F62BED95900A6127C9A7A62252E6208F29C8D6F849AA4C895C95EFC984F4388D295CB72449952B25F66F91F8B5AB046942EF06171CDDE3BF967EE1C8C2A27AEB37919D6C17C232D60ED64A580C2F2A474B7F27A66911174D4E7FA7CD7E973FA73C71FDA7982C6D7EC2A04E3F25676CE35D2945DA36BE82AAABA69C67AA4EB5B9F3741D3493CD5157229B17ABC82A139F9913EE35E7DB53F36FCC5524F6C81B015287FC67557FC69C4BDA011A93F6998665B7349A55AF3FE99648BDFA63A50D94B2742940437F6AA1CFC822E1F634F2E5B13853E75C9ACA90B7960B4FD4013EF6C8347C95B2CA0192830FBD7F96BBF6C2BDA3A16E23879D12D41531EC53980E45F64E531E504DF48BE4AF8849314C4315F19B8FCD19748865AA3FE310D5F134BD847BA821B6482F28C7CF10337313D1BBC1FCD7054CD1AA26312734A3FCE5464DB4AC731D2DE3D2D015382AAB88D77E10039F589FA709464BE061F2D983699AFDCF9E07106C48954B82DDFE7574BBC1EB0D26432658CE471D537BD9D47F964391E7797EBBCEFE23DA1043C8E2C98896DD46671B14F815DF578AEB350D096A881717FA742D31BDD85FBD5594BEC59125A162FA2AFFA1B28E6EA305A0A1313ADE9AE7909FB1F90502AB84A84141A36E4F7E12F1F3C3D75FFE0FE532B491378B0000, '5.0.0.net45')
